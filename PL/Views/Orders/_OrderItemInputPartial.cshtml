@model PL.ViewModels.Orders.OrderItemInputViewModel

@{
    // استقبال الـ Index من ViewData (هذا Index يحدد موقع العنصر في قائمة OrderItems)
    var index = (int)ViewData["Index"];
    // هذا السطر حاسم لكي يعمل الـ Model Binding لـ List<T> بشكل صحيح مع الـ Tag Helpers
    // يحدد الـ Prefix لأسماء حقول الـ HTML (مثال: OrderItems[0].MenuItemId)
    ViewData.TemplateInfo.HtmlFieldPrefix = $"OrderItems[{index}]";
}

<div class="order-item-row border p-3 mb-3 bg-light rounded shadow-sm">
    <div class="row g-3 align-items-end">
        <div class="col-md-7">
            <label asp-for="MenuItemId" class="form-label"></label>
            @* asp-for هنا سينشئ الاسم (name) و الـ ID الصحيحين (مثال: OrderItems_0__MenuItemId) *@
            <select asp-for="MenuItemId" class="form-control" asp-items="ViewBag.MenuItems" required>
                <option value="">-- Select Menu Item --</option>
            </select>
            <span asp-validation-for="MenuItemId" class="text-danger"></span>
        </div>
        <div class="col-md-3">
            <label asp-for="Quantity" class="form-label"></label>
            <input asp-for="Quantity" class="form-control" type="number" value="1" min="1" required />
            <span asp-validation-for="Quantity" class="text-danger"></span>
        </div>
        <div class="col-md-2 d-flex justify-content-end">
            <button type="button" class="btn btn-outline-danger remove-item" title="Remove Item"><i class="fas fa-trash-alt"></i></button>
        </div>
    </div>
</div>